### 第一讲 CPU的基本功能和基本组成
CPU功能
指令四个基本功能
数据通路结构
寄存器与同步电路设计  -> EE/Digital_Circuit/[[Chapter 3 Sequential Logic Design]]
数据通路实现
总线数据通路结构

### 第二讲 单周期MIPS处理器的设计

一条指令都在一个时钟周期内执行完毕
效率低，关键路径时长就是CLK的周期
Based on ISA, design Datapath(including Operation components and store/state components, implemented by combinational circuit and sequential logic, respectively) and Controller.

**控制信号**是指决定某器件执行的功能的code

#### Instruction Fetch Logic
单周期CPU的时钟周期以下降开始，在本时钟周期中PC不变。
两个操作的顺序：先取指令，再改PC的值。
绝不能先改PC的值，再取指令.
32bit PC 跳转左移两位，因为一条指令4Byte
30bit PC 减少PC位数，因为每次都是+4，这样跳转也不用移位

ALU MUXs Registers -> DataPath
![[Pasted image 20230611203655.png]]

关键路径时长(Load) = PC的 Clk-to-Q时间 +指令存储器的取数时间 +寄存器组的取数时间+ALU 加法延时+ 数据存储器的取数时间+写寄存器的建立时间+时钟偏移.

### 第三讲 微程序控制原理与异常处理

#### 微程序设计
硬链接控制器速度快，但太复杂，是一个巨大逻辑网络。'
微程序控制器：每个微程序由若干条微指令构成，一条微指令包含若干个微命令。微程序存储在只读存贮器中，也叫控制存储器CS *Control Storage*
![[Pasted image 20230425232345.png]]

**水平型微指令** 相容微命令尽量多地安排在一条微指令中。微程序短，并行性高，微指令长。
**垂直型微指令** 一条微指令只控制一、二个微命令。微程序长，无并行，速度慢。


![[Pasted image 20230425232545.png]]
> ChatGPT:硬连线控制器和微程序控制器各有优缺点。硬连线控制器速度快，但修改和扩展困难。微程序控制器则相反，灵活性好，易于修改和扩展，但速度较慢。

#### CPU对异常的处理
CPU执行时遇到特殊情况导致正在执行的程序被中断
中断分类
- 内部异常
	- 硬件异常 电源掉电
	- 程序性异常 指令的exception 溢出 等
	- 处理方式
		- 故障 Fault 
			- 执行指令引起的异常事件，如溢出、缺页、堆栈溢出、访问超时等。
			- 断点：就是这条指令
		- 自陷 Trap 
			- 预先安排的事件，如单步跟踪、系统调用(执行访管指令)等。是一种自愿中断。
			- 断点：下一条指令
		- 终止 Abort
			- 硬故障事件，此时机器将“终止”，调出中断服务程序来重启操作系统。
			- 断点随意
- 外部中断
	- 外部硬件向CPU发中断请求信号

缺页、TLB缺失等：补救后可继续，回到发生故障的指令重新执行； 
溢出、除数为0、非法操作、内存保护错等：终止当前进程。

异常处理机制：两种识别方式 软件识别或硬件识别

数据通路的异常处理部件 如何控制
